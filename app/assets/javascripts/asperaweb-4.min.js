/*
* Revision: 3.6.1.105852
* Revision date: 04/30/2015
*
* http://www.asperasoft.com/
*
* Â© Copyright IBM Corp. 2008, 2015, Copyright (C) 1991, 1999 Free Software Foundation, Inc.
*/
"use strict";if(typeof AW4=="undefined")var AW4={};AW4.Utils=function(){var FASP_URL="fasp://initialize",ua=typeof navigator!="undefined"?navigator.userAgent:"",BROWSER={OPERA:/opera|opr/i.test(ua),IE:/msie|trident/i.test(ua),CHROME:/chrome|crios|crmo/i.test(ua)&&!/opera|opr/i.test(ua),FIREFOX:/firefox|iceweasel/i.test(ua),SAFARI:/safari/i.test(ua)};(function(){var JSON;window.JSON||(window.JSON={}),function(){function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g;return e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)typeof rep[c]=="string"&&(d=rep[c],e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g;return e}}function quote(a){escapable.lastIndex=0;return escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function f(a){return a<10?"0"+a:a}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof window.JSON.stringify!="function"&&(window.JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c=="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(b&&typeof b!="function"&&(typeof b!="object"||typeof b.length!="number"))throw new Error("JSON.stringify");return str("",{"":a})}),typeof window.JSON.parse!="function"&&(window.JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver=="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")})}()})(),function(){if(document.all&&!window.setTimeout.isPolyfill){var a=window.setTimeout;window.setTimeout=function(b,c){var d=Array.prototype.slice.call(arguments,2);return a(b instanceof Function?function(){b.apply(null,d)}:b,c)},window.setTimeout.isPolyfill=!0}if(document.all&&!window.setInterval.isPolyfill){var b=window.setInterval;window.setInterval=function(a,c){var d=Array.prototype.slice.call(arguments,2);return b(a instanceof Function?function(){a.apply(null,d)}:a,c)},window.setInterval.isPolyfill=!0}}();var createError=function(a,b){var c="";a==-1&&(c="Invalid request");return{error:{code:a,internal_message:c,user_message:b}}},parseJson=function(a){var b;if(typeof a=="string"&&(a.length===0||a.replace(/\s/g,"")==="{}"))return{};try{b=JSON.parse(a)}catch(c){b=createError(-1,c)}return b},versionLessThan=function(a,b){var c=function(a){var b=a.split("."),c=[];for(var d=0;d<b.length;d++)isNaN(parseInt(b[d]))&&AW.utils.logger("Warning: Version contains non-numbers"),c.push(parseInt(b[d],10));return c},d=c(a),e=c(b),f;for(f=0;f<Math.min(d.length,e.length);f++){if(d[f]<e[f])return!0;if(d[f]>e[f])return!1}return!1},generateUuid=function(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=((a+16)*Math.random()).toFixed()%16;b!=="x"&&(c=c&3|8);return c.toString(16)})},launchConnect=function(a){var b=function(b){typeof a=="function"&&a(b)},c=!1;if(BROWSER.CHROME||BROWSER.OPERA)document.body.focus(),document.body.onblur=function(){c=!0},document.location=FASP_URL,setTimeout(function(){document.body.onblur=null,b(c)},500);return null};return{FASP_URL:FASP_URL,BROWSER:BROWSER,versionLessThan:versionLessThan,createError:createError,generateUuid:generateUuid,launchConnect:launchConnect,parseJson:parseJson}}(),AW4.XMLhttpRequestImplementation=function(){var a=function(a){typeof a.callback=="function"&&a.callback()},b=function(){if(c()===null)return!1;return!0},c=function(){typeof XMLHttpRequest=="undefined"&&(XMLHttpRequest=function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(a){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}return null});return new XMLHttpRequest},d=function(a,b,d,e,f){var g=c();g.onreadystatechange=function(a){g.readyState==4&&e(g.status,g.responseText,f)},g.open(a,b,!0),a.toUpperCase()==="GET"?g.send():g.send(d);return null};return{isSupportedByBrowser:b,init:a,httpRequest:d}}(),AW4.NPAPIrequestImplementation=function(){function h(b,c,d,e,f){if(a!=null){var g=function(a){var b=AW4.Utils.parseJson(a);typeof b.error!="undefined"?e(b.error.code,a,f):e(200,a,f)};d==null&&(d=""),a.httpRequestImplementation(b,c,d,g);return null}}function g(g){var h=g.callback||function(){};try{if(!!e()&&a==null)if(AW4.Utils.BROWSER.IE&&new ActiveXObject("Aspera.AsperaWebCtrl.1")||navigator.mimeTypes[d()]!==undefined){c=g.containerId,b=g.pluginId,f(g.initializeTimeout);var i=setInterval(function(){if(!a||!a.queryBuildVersion)return null;clearInterval(i),AW4.Utils.versionLessThan(a.queryBuildVersion(),"3.6")?(a=null,h(AW4.Connect.STATUS.FAILED)):h(AW4.Connect.STATUS.RUNNING)},500)}else a==null&&h(AW4.Connect.STATUS.FAILED)}catch(j){h(AW4.Connect.STATUS.FAILED)}return null}function f(e){var f=document.getElementById(c);if(f==null)f=document.createElement("div"),f.setAttribute("id",c);else while(f.firstChild)f.removeChild(f.firstChild);a=document.createElement("object"),a.setAttribute("name",b),a.setAttribute("id",b),a.setAttribute("type",d()),a.setAttribute("width",1),a.setAttribute("height",1);var g=document.createElement("param");g.setAttribute("name","connect-launch-wait-timeout-ms"),g.setAttribute("value",e),a.appendChild(g),f.appendChild(a),document.body.appendChild(f)}function e(){if(AW4.Utils.BROWSER.IE||AW4.Utils.BROWSER.FIREFOX||AW4.Utils.BROWSER.SAFARI)return!0;return!1}function d(){return"application/x-aspera-web"}var a=null,b=null,c=null;return{isSupportedByBrowser:e,init:g,httpRequest:h}}(),AW4.PPAPIrequestImplementation=function(){function p(c,e,f,g,h){if(d!=null){var i=b++,j={id:h,callback:g};a[i]=j,d.postMessage({id:i,method:c,url:e,data:f})}}function o(a){if(!!g()&&d==null){e=a.callback||function(){},c=a.pluginId;var b=h(a.containerId);i(b);var f=j(a.sdkLocation);b.appendChild(f),document.body.appendChild(b)}}function n(b){if(typeof b.data=="object"){var c=b.data.id;if(typeof a[c]=="undefined")return;var d=a[c].callback,e=a[c].id;if(!d)return;var f=b.data.status,g=b.data.response;d(f,g,e),delete a[c]}}function m(){d=document.getElementById(c),e()}function l(a){}function k(a){}function j(a){var b=document.createElement("embed");b.setAttribute("name",c),b.setAttribute("id",c),b.setAttribute("path","plugin/chrome"),b.setAttribute("src",a.replace(/\/$/,"")+"/plugin/chrome/url_loader.nmf"),b.setAttribute("type",f());return b}function i(a){a.addEventListener("load",m,!0),a.addEventListener("message",n,!0),a.addEventListener("error",k,!0),a.addEventListener("crash",l,!0)}function h(a){var b=document.getElementById(a);if(b==null)b=document.createElement("div"),b.setAttribute("id",a);else while(b.firstChild)b.removeChild(b.firstChild);return b}function g(){return navigator.mimeTypes[f()]!==undefined}function f(){return"application/x-pnacl"}var a={},b=0,c=null,d=null,e=null;return{isSupportedByBrowser:g,init:o,httpRequest:p}}(),AW4.RequestHandler=function(){var a={GET:"GET",POST:"POST"},b={INITIALIZING:0,RETRYING:1,RUNNING:2,FAILED:3},c=33003,d="http://127.0.0.1:",e="/v5/connect",f=10,g=2e3,h=null,i=null,j=c,k=0,l={},m=[],n=null,o=function(){for(var a=0;a<m.length;a++){var b=m.pop(),c=d+b.port+e+b.path;h.httpRequest(b.method,c,b.data,s,b.id)}return null},p=function(a){i=a,i==b.RUNNING&&o(),n!==null&&n(i);return null},q=function(g,m,n){var o=l[n].port;delete l[n];if(i==b.RUNNING)return null;if(g==200)j=o,p(b.RUNNING);else if(o===c)for(var r=c+1;r<c+f;r++){var s=k++,t=a.GET,u="/info/ping",v=d+r+e+u,w={id:s,method:t,port:r,path:u,data:null,callbacks:null};l[s]=w,h.httpRequest(t,v,null,q,s)}return null},r=function(f){if(i==b.RUNNING)return null;i==b.INITIALIZING&&!f&&(AW4.Utils.launchConnect(),p(b.RETRYING)),setTimeout(r,g);var j=k++,m=a.GET,n="/info/ping",o=d+c+e+n,s={id:j,method:m,port:c,path:n,data:null,callbacks:null};l[j]=s,h.httpRequest(m,o,null,q,j);return null},s=function(a,c,d){var e=l[d];if(!!e){if(a==0){if(i==b.INITIALIZING||i==b.RUNNING)p(b.RETRYING),AW4.Utils.launchConnect(),r();m.push(e);return null}i!=b.RUNNING&&p(b.RUNNING);var f=AW4.Utils.parseJson(c);if(a==200&&typeof f.error=="undefined"){var g=e.callbacks.success;g(f)}else{var g=e.callbacks.error;g(f)}delete l[d];return null}},t=function(a,c,f,g){typeof g=="undefined"&&(g={}),typeof g.success!="function"&&(g.success=function(){}),typeof g.error!="function"&&(g.error=function(){});var n=k++,o={id:n,method:a,port:j,path:c,data:f,callbacks:g};l[n]=o;if(i!=b.RUNNING){m.push(o);return null}var p=d+j+e+c;h.httpRequest(a,p,f,s,n);return null},u=function(a){n=a},v=function(a){p(b.INITIALIZING),h=function(){if(AW4.PPAPIrequestImplementation.isSupportedByBrowser())return AW4.PPAPIrequestImplementation;if(AW4.NPAPIrequestImplementation.isSupportedByBrowser())return AW4.NPAPIrequestImplementation;if(AW4.XMLhttpRequestImplementation.isSupportedByBrowser())return AW4.XMLhttpRequestImplementation;return"This browser is not supported"}();if(typeof h=="string")return AW4.Utils.createError(-1,h);var c=function(){var c=function(){i!=b.RUNNING&&p(b.FAILED)};setTimeout(c,a.initializeTimeout),r(!0)},d={pluginId:a.pluginId,containerId:a.containerId,initializeTimeout:a.initializeTimeout,sdkLocation:a.sdkLocation,callback:c};h.init(d);return null};return{HTTP_METHOD:a,STATUS:b,init:v,start:t,addStatusListener:u}}(),AW4.Connect=function(a){function z(a){if(p==AW4.Connect.STATUS.OUTDATED)return null;if(a==m.STATUS.INITIALIZING)p=AW4.Connect.STATUS.INITIALIZING;else if(a==m.STATUS.RETRYING)p=AW4.Connect.STATUS.RETRYING;else if(a==m.STATUS.FAILED)p=AW4.Connect.STATUS.FAILED;else{if(i!=""&&o==""){var b=function(a){o=a.version,p=AW4.Connect.STATUS.RUNNING,y(p)},c=function(a){p=AW4.Connect.STATUS.OUTDATED,y(p)},d={success:b,error:c};s(AW4.Connect.HTTP_METHOD.POST,"/update/require",{min_version:i,sdk_location:e},d);return null}p=AW4.Connect.STATUS.RUNNING}y(p)}function y(a){for(var b=0;b<n.length;b++)var c=n[b](AW4.Connect.EVENT.STATUS,a)}function x(a){var b=a||"//d3gcli72yxqn2z.cloudfront.net/connect/v4",c=document.createElement("a");c.href=b;return c.href}function w(a,b){var c=!1,d=b.indexOf(a);while(d>-1)b.splice(d,1),c=!0,d=b.indexOf(a);return c}function v(){t(l,{success:u})}function u(a){l=a.iteration_token;for(var b=0;b<j.length;b++)j[b](AW4.Connect.EVENT.TRANSFER,a)}function t(a,b){if(q(a))return null;var c={iteration_token:a};return s(AW4.Connect.HTTP_METHOD.POST,"/transfers/activity",c,b)}function s(a,b,c,d){q(c)&&(c={});var e=JSON.stringify(r(c));m.start(a,b,e,d);return null}function r(a){g.length!==0&&(a.authorization_key=g),q(a.aspera_connect_settings)&&(a.aspera_connect_settings={}),a.aspera_connect_settings.app_id=f;return a}function q(a){return a===""||a===null||typeof a=="undefined"}q(a)&&(a={}),AW4.Connect.HTTP_METHOD={GET:"GET",POST:"POST"},AW4.Connect.STATUS={INITIALIZING:"INITIALIZING",RETRYING:"RETRYING",RUNNING:"RUNNING",OUTDATED:"OUTDATED",FAILED:"FAILED"},AW4.Connect.EVENT={ALL:"all",TRANSFER:"transfer",STATUS:"status"},AW4.Connect.TRANSFER_STATUS={CANCELLED:"cancelled",COMPLETED:"completed",FAILED:"failed",INITIATING:"initiating",QUEUED:"queued",REMOVED:"removed",RUNNING:"running",WILLRETRY:"willretry"};var b=a.connectLaunchWaitTimeoutMs||5e3,c=a.id||"aspera-web",d=a.containerId||"aspera-web-container",e=x(a.sdkLocation),f="",g=a.authorizationKey||"",h=a.pollingTime||2e3,i=a.minVersion||"",j=[],k=0,l=0,m=AW4.RequestHandler,n=[],o="",p=AW4.Connect.STATUS.INITIALIZING;m.addStatusListener(z),this.addEventListener=function(a,b){if(typeof a!=typeof AW4.Connect.EVENT.ALL)return AW4.Utils.createError(-1,"Invalid EVENT parameter");if(typeof b!="function")return AW4.Utils.createError(-1,"Invalid Listener parameter");a==AW4.Connect.EVENT.TRANSFER||a==AW4.Connect.EVENT.ALL?(k===0&&(k=setInterval(v,h)),j.push(b)):(a==AW4.Connect.EVENT.STATUS||a==AW4.Connect.EVENT.ALL)&&n.push(b);return null},this.authenticate=function(a,b){if(q(a))return AW4.Utils.createError(-1,"Invalid authSpec parameter");s(AW4.Connect.HTTP_METHOD.POST,"/info/authenticate",a,b);return null},this.getAllTransfers=function(a,b){q(b)&&(b=0),t(b,a);return null},this.getStatus=function(){return p},this.initSession=function(a){if(q(f))q(a)?f="^"+q(window.location.hostname)?"localhost":window.location.hostname:f=a;else return AW4.Utils.createError(-1,"Session was already initialized");var g={pluginId:c,containerId:d,initializeTimeout:b,sdkLocation:e},h=m.init(g);if(h==null)return{app_id:f};return h},this.modifyTransfer=function(a,b,c){s(AW4.Connect.HTTP_METHOD.POST,"/transfers/modify/"+a,b,c);return null},this.readAsArrayBuffer=function(a,b){var c={};if(!a)return AW4.Utils.createError(-1,"Invalid options parameter");s(AW4.Connect.HTTP_METHOD.POST,"/file/read-as-array-buffer/",a,b);return null},this.readChunkAsArrayBuffer=function(a,b){if(!a.path||!a.offset||!a.chunkSize)return AW4.Utils.createError(-1,"Invalid parameters");s(AW4.Connect.HTTP_METHOD.POST,"/file/read-chunk-as-array-buffer/",a,b);return null},this.removeEventListener=function(a,b){var c=!1;if(typeof a=="undefined")j.length>0&&(j=[],c=!0),n.length>0&&(n=[],c=!0);else if(typeof a!=typeof AW4.Connect.EVENT.ALL)c=c||w(a,j),c=c||w(a,n);else if(typeof b!="function")(a===AW4.Connect.EVENT.TRANSFER||a===AW4.Connect.EVENT.ALL)&&j.length>0&&(j=[],c=!0),(a===AW4.Connect.EVENT.STATUS||a===AW4.Connect.EVENT.ALL)&&n.length>0&&(n=[],c=!0);else{if(a===AW4.Connect.EVENT.TRANSFER||a===AW4.Connect.EVENT.ALL)c=c||w(b,j);if(a===AW4.Connect.EVENT.STATUS||a===AW4.Connect.EVENT.ALL)c=c||w(b,n)}j.length===0&&(clearInterval(k),k=0);return c},this.removeTransfer=function(a,b){s(AW4.Connect.HTTP_METHOD.POST,"/transfers/remove/"+a,null,b);return null},this.resumeTransfer=function(a,b,c){s(AW4.Connect.HTTP_METHOD.POST,"/transfers/resume/"+a,b,c);return null},this.showAbout=function(a){s(AW4.Connect.HTTP_METHOD.GET,"/windows/about",null,a);return null},this.showDirectory=function(a,b){s(AW4.Connect.HTTP_METHOD.GET,"/windows/finder/"+a,null,b);return null},this.showPreferences=function(a){s(AW4.Connect.HTTP_METHOD.GET,"/windows/preferences",null,a);return null},this.showSaveFileDialog=function(a,b){q(b)&&(b={}),b.title=b.title||"",b.suggestedName=b.suggestedName||"",b.allowedFileTypes=b.allowedFileTypes||"",s(AW4.Connect.HTTP_METHOD.POST,"/windows/select-save-file-dialog/",b,a);return null},this.showSelectFileDialog=function(a,b){q(b)&&(b={}),b.title=b.title||"",b.suggestedName=b.suggestedName||"",b.allowMultipleSelection=q(b.allowMultipleSelection)||b.allowMultipleSelection,b.allowedFileTypes=b.allowedFileTypes||"",s(AW4.Connect.HTTP_METHOD.POST,"/windows/select-open-file-dialog/",b,a);return null},this.showSelectFolderDialog=function(a,b){q(b)&&(b={}),b.title=b.title||"",b.allowMultipleSelection=q(b.allowMultipleSelection)||b.allowMultipleSelection,s(AW4.Connect.HTTP_METHOD.POST,"/windows/select-open-folder-dialog/",b,a);return null},this.showTransferManager=function(a){s(AW4.Connect.HTTP_METHOD.GET,"/windows/transfer-manager",null,a);return null},this.showTransferMonitor=function(a,b){s(AW4.Connect.HTTP_METHOD.GET,"/windows/transfer-monitor/"+a,null,b);return null},this.startTransfer=function(a,b,c){if(q(a))return AW4.Utils.createError(-1,"Invalid transferSpec parameter");b=b||{};var d={transfer_specs:[{transfer_spec:a,aspera_connect_settings:b}]};return this.startTransfers(d,c)},this.startTransfers=function(a,b){if(q(a))return AW4.Utils.createError(-1,"Invalid transferSpecs parameter");var c,d,e,f;d=AW4.Utils.generateUuid();for(c=0;c<a.transfer_specs.length;c++)f=a.transfer_specs[c],r(f),f.aspera_connect_settings.request_id=d,q(f.aspera_connect_settings.back_link)&&(f.aspera_connect_settings.back_link=window.location.href);s(AW4.Connect.HTTP_METHOD.POST,"/transfers/start",a,b);return{request_id:d}},this.stopTransfer=function(a,b){s(AW4.Connect.HTTP_METHOD.POST,"/transfers/stop/"+a,null,b);return null},this.version=function(a){if(q(a))return null;s(AW4.Connect.HTTP_METHOD.GET,"/info/version",null,a);return null}};