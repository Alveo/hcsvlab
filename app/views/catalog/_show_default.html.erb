<%# default partial to display solr document fields in catalog show view -%>
<h3>Item Details</h3>
<dl class="dl-horizontal  dl-invert">
    <% document_show_fields(document).each do |solr_fname, field| -%>
      <% if should_render_show_field? document, field %>
        <dt class="blacklight-<%= solr_fname.parameterize %>"><%= render_document_show_field_label document, :field => solr_fname %></dt>
        <% if solr_fname == 'http://www.language-archives.org/OLAC/1.1/language_tesim' %>
          <dd class="blacklight-<%= solr_fname.parameterize %>"><%= raw render_language_codes document[solr_fname] %></dd>
        <% elsif solr_fname == 'http://purl.org/dc/terms/type_tesim' %>
          <dd class="blacklight-<%= solr_fname.parameterize %>"><%= format_duplicates(document[solr_name]) %></dd>
        <% else %>
          <dd class="blacklight-<%= solr_fname.parameterize %>"><%= render_document_show_field_value document, :field => solr_fname %></dd>
        <% end -%>
      <% end -%>
    <% end -%>
    <% do_not_display = {'id' => nil,
                         'timestamp' => nil,
                         'http://www.w3.org/1999/02/22-rdf-syntax-ns#type_tesim' => nil,
                         'date_group_tesim' => nil} %>
    <% do_not_display.merge!(document_show_fields(document)) %>

    <% document.keys.each do |k| -%>
      <% v = document[k] %>
      <% unless do_not_display.has_key?(k) %>
        <dt class="blacklight"><%= format_key(k) %></dt>
        <% if k == 'http://purl.org/dc/terms/type_tesim' %>
            <dd class="blacklight"><%= format_duplicates(v) %></dd>
        <% else %>
            <dd class="blacklight"><%= format_value(v) %></dd>
        <% end %>
      <% end %>
    <% end -%>
  <dt class="blacklight-fedora-id">HCSvLab ID:</dt>
  <dd class="blacklight-fedora-id"><%= document.id %></dd>
</dl>

<h3>Documents</h3>
<% uris = [PURL::IDENTIFIER, PURL::TYPE, PURL::EXTENT, PURL::SOURCE] %>
<% documents = item_documents(document, uris) %>
<% if documents.empty? %>
    <em>This Item has no documents</em>
<% else %>
    <% is_cooee = document[PURL::IS_PART_OF.to_s + "_tesim"][0] == "cooee" %>
    <% type = nil %>
    <% if is_cooee %>
        <% if document.has_key?(PURL::TYPE.to_s + "_tesim") %>
        <%   document[PURL::TYPE.to_s + "_tesim"].each { |t| type = t unless t == "Original" or t == "Raw" } %>
        <% end %>
        <% if type.nil? %>
        <%   type_format = '%s' %>
        <% else %>
        <%   type_format = type + '(%s)' %>
        <% end %>
    <% else %>
        <% type_format = '%s' %>
    <% end %>
    <table class="document-table table table-striped" border="1">
        <thead>
            <tr>
                <th>Filename</th>
                <th>Type</th>
                <th>Size</th>
            </tr>
        </thead>
        <tbody>
            <% documents.each do |values| -%>
                <tr>
                    <% if values.has_key?(PURL::SOURCE) %>
                        <td><a href="<%= values[PURL::SOURCE] %>"><%= values[PURL::IDENTIFIER] %></a></td>
                    <% else %>
                        <td><%= values[PURL::IDENTIFIER] %></td>
                    <% end %>
        
                    <% if values.has_key?(PURL::TYPE) %>
                    <%   field = values[PURL::TYPE] %>
                    <%   field = "unlabelled" if field == "" %>
                    <%   field = "Plain"   if is_cooee && field == type %>
                    <% else %>
                    <%   field = "unlabelled" %>
                    <% end %>
                    <td><%= sprintf(type_format, field) %></td>
        
                    <% if values.has_key?(PURL::EXTENT) %>
                    <%   field = values[PURL::EXTENT] %>
                    <%   if field.nil? || field == "" %>
                    <%     field = "unknown" %>
                    <%   else %>
                    <%     field = format_extent(field.to_i, 'B') %>
                    <%   end %>
                    <% else %>
                    <%   field = "unknown" %>
                    <% end %>
                    <td><%= field %></td>
                </tr>
            <% end -%>
        </tbody>
    </table>
<% end %>


