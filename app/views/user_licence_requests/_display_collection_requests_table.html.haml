%table#access_requests.table.table-condensed
  %tr
    %th First name
    %th Last name
    %th Email
    %th Collection/Collection List
    %th Actions
  - @requests.each_with_index do |request, index|
    - @user = User.find(request.user)
    %tr{:class => cycle('field_bg', 'field_nobg')}
      %td= @user.first_name
      %td= @user.last_name
      %td= @user.email
      - if request.request.is_a? CollectionList
        %td.name
          %a.btn.btn-mini{"data-toggle" => "modal", :href => "#collection#{index}", :role => "button"}=request.request.flat_name
          .modal.hide.fade.in{:id => "collection#{index}","aria-hidden" => "true", "aria-labelledby" => "myModalLabel", :role => "dialog", :tabindex => "-1"}
            .modal-header
              %button.close{"aria-hidden" => "true", "data-dismiss" => "modal", :type => "button"} Ã—
              %h3#myModalLabel= request.request.flat_name
            #collection_list_detail_dialog.modal-body{:title => "Licence Terms"}
              #collection_list_detail_content{:readonly => "true"}
                %table
                  - request.request.collections.each do |aCollection|
                    %tr
                      %td
                        =aCollection.flat_name
            .modal-footer
              %a.btn.pull-left{"aria-hidden" => "true()", "data-dismiss" => "modal"} Close
      - else
        %td= link_to request.request.flat_name, collection_path(request.request)
      %td
      /   - if can?(:approve, user) then
      /     = link_to "Approve", edit_approval_user_path(user), :id => "approve_#{user.id}", :class => "btn btn-primary btn-mini"
      /   - if can?(:reject, user) then
      /     = link_to "Reject", reject_user_path(user), :method => :put, :id => "reject_#{user.id}", :class => "btn btn-danger btn-mini"
      /     = link_to "Reject as Spam", reject_as_spam_user_path(user), :method => :put, :id => "reject_as_spam_#{user.id}", :class => "btn btn-warning btn-mini"
      /   = link_to "View Details", user, :id => "view_#{user.id}", :class => "btn btn-mini"