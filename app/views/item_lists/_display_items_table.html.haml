-if !@response.nil?
  #content
    .well.clearfix
      .css-dropdown.pull-left
        %a.btn{:'data-toggle'=>"dropdown", :href=>"#"}
          Item List Actions
          %span.caret
        %ul.dropdown-menu
          %li
            = link_to("Clear Item List", {:controller => "item_lists", :action => "clear"}, :method => 'POST', :id => params[:id].to_i)
          %li
            %a{"data-toggle" => "modal", :href => "#use_in_galaxy", :role => "button"} Use Item List in Galaxy
          %li
            %a{"data-toggle" => "modal", :href => "#get_r_script", :role => "button"} Use Item List in Emu/R
            =# link_to("Concordance search", {:controller => "item_lists", :action => "concordance"}, :method => 'GET', :id => params[:id].to_i)
          %li
            = link_to("Download as ZIP", {:controller => "item_lists", :action => "show", :format=>"zip"}, :method => 'GET', :id => params[:id].to_i, :onclick => 'showProgressAnimation(); self.setInterval("checkCompleteCookie();", 4000);')
      - if (@document_list.empty?)
      - else
        = render 'catalog/paginate_compact'
        = render 'catalog/per_page_widget'
    - if (@document_list.empty?)
      .info
        Item List is
        %strong empty
        %a.close{"data-dismiss" => "alert", :href => "#"} ×
    - else
      = render_document_index nil, {}, {:showCheckbox => false, :itemViewList => params[:id]}
      = render 'results_pagination'
  .modal.hide.fade.in{:id => "get_r_script","aria-hidden" => "true", "aria-labelledby" => "myModalLabel", :role => "dialog", :tabindex => "-1"}
    .modal-header
      %button.close{"aria-hidden" => "true", "data-dismiss" => "modal", :type => "button"} ×
      %h3#myModalLabel= "Use " + @item_list.name + " in Emu/R"
    #r_script_dialog.modal-body
      %p
        Copy the following code into your R environment and download the API token file.
        Make sure you have the required R packages installed prior to execution.
      %hr
      %p
        Save the following file to your home directory
      = "Linux or Unix: /home/<user>"
      %br
      = "Mac: /Users/<user>"
      %br
      = "Windows: C:\\Users\\<user>"
      %br
      %br
      = link_to "Download API key config file", account_api_key_path
      %hr
      %pre
        = preserve do
          .r_script_content{:readonly => "true"}= @item_list.getRScript(root_url)
    .modal-footer
      %a.btn.btn-primary{"aria-hidden" => "true()", "data-dismiss" => "modal"} Close

  .modal.hide.fade.in{:id => "use_in_galaxy","aria-hidden" => "true", "aria-labelledby" => "myModalLabel", :role => "dialog", :tabindex => "-1"}
    .modal-header
      %button.close{"aria-hidden" => "true", "data-dismiss" => "modal", :type => "button"} ×
      %h3#myModalLabel= "Use " + @item_list.name + " in Galaxy"
    .use_galaxy_dialog.modal-body
      %div#use_galaxy_intermediary.use_galaxy_intermediary
        %p#use_galaxy_text.use_galaxy_text
          If you are not currently logged in to Galaxy proceed to the login screen via the button below.
          If you are logged in, click Use Item list in Galaxy to open up the tool page here in this dialog.
        %br
        %a#use_galaxy_login.btn{ :href => Rails.application.config.galaxy_url, :target => "_blank", :role => "button" } Login to Galaxy
        %a#use_galaxy_load_frame.btn.btn-primary{ :onclick => "prepare_iframe('use_galaxy_frame', '#{@galaxy_tool_source}')", :role => "button" } Use Item list in Galaxy
      %iframe#use_galaxy_frame.use_galaxy_frame
    .modal-footer
      %a.btn.btn-primary{"aria-hidden" => "true()", "data-dismiss" => "modal"} Close

:javascript

  function checkCompleteCookie() {
    if ($.cookie("download_finished") ) {
      $.removeCookie("download_finished");
      location.reload();
    }
  }

  function prepare_iframe(iframe, source) {
    document.getElementById("use_galaxy_intermediary").style.display = 'none';
    document.getElementById(iframe).src = source;
    document.getElementById(iframe).style.display = 'block';
  }